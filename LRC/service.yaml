name: LRC
title: Linear Rule Checking
description: |
  Linear Rule Checking
version: 0.1.0
wd: .
input:
  data:
    data:
      name: data
      type: url
      description: |
        url to csv file with data to be checked
        Data should be numeric
      required: yes
    schema:
      name: metadata
      type: url
      description: |
        url to json table schema  of structure of data
      required: no
  rules:
    name: rules
    type: url
    description: |
      url to text file with rules to be used in checking
      LRC supports several rules
    required: yes
result:
  title: Results of this service
  type: object
  properties:
    checks:
      title: checks
      type: "object"
      description: |
        Contains data and data structure to the results of checking the record
      properties: 
        data: 
          type: string
          description: |
            url to a csv file that is generated by LRC
          mimetype: "text/csv"
          filename: checks.csv
          value: "{job.url}/result/checks/data"
        schema: 
          type: string
          description: |
            url to a json table schema file that is generated by LRC
          mimetype: "application/json"
          filename: checks_schema.json
          value: "{job.url}/result/checks/schema"
        type:
          type: string
          value: "json"
command: >
  Rscript {service.servicedir}/LRC.R
  {job.input.data.data}
  {job.input.rules}
  {if job.input.data.schema}{job.input.data.schema}{/if}
  --output checks.csv
